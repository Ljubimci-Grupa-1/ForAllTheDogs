\chapter{Implementacija i korisničko sučelje}
		
		
		\section{Korištene tehnologije i alati}
		
			Komunikacija u timu ostvarena je pomoću platforme Discord\footnote{\url{https://discord.com}} koja nudi opcije tekstualnog dopisivanja, glasovnog poziva i videopoziva. U serveru našeg projektnog tima postojalo je nekoliko kanala koji su se bavili različitim temama (back-end, front-end, dokumentacija…) što nam je pomoglo u podjeli posla i filtriranju zadataka. Za izradu UML dijagrama koristili smo se aplikacijom Astah\footnote{\url{https://astah.net}} pomoću koje smo vrlo jednostavno napravili željene dijagrame i time pokazali ideju projektnog zadatka, kao i način rada naše aplikacije. Kao sustav za upravljanje izvornim kodom koristili smo Git\footnote{\url{https://git-scm.com}}. Udaljeni repozitorij projekta dostupan je na web platformi GitHub\footnote{\url{https://github.com}}. \\
Za razvojno okruženje koristili smo Visual Studio Code\footnote{\url{https://code.visualstudio.com}} i IntelliJ IDEA\footnote{\url{https://jetbrains.com/idea}}. VSC nudi široku podršku za jezike i ekstenzije, integraciju s Git-om i različitim alatima i servisima (Docker\footnote{\url{https://docker.com}}) te snimanje koraka za debuggiranje. Također, dolazi s ugrađenom podrškom za JavaScript i TypeScript. IntelliJ IDEA nudi naprednu podršku za pisanje koda (Code Assistance), odličan debugger, refaktoriranje koda te podršku za različite tehnologije (Spring Framework, JavaScript, HTML, CSS, TypeScript, React, SQL) i jezike (Java, Kotlin, Groovy). \\
Klijentska strana aplikacije (\textit{front-end}) napisana je React\footnote{\url{https://react.dev}}-om preko TypeScript\footnote{\url{https://typescriptlang.org}}-a i Vite.js\footnote{\url{https://vitejs.dev}}-om. Material UI\footnote{\url{https://mui.com/material-ui}} je biblioteka React komponenata koja pruža implementaciju Google-ovog Material Design koncepta u React aplikacijama, a fokusiran je na stvaranje dosljednih i intuitivnih korisničkih sučelja.\\
Poslužiteljska strana aplikacije (\textit{back-end}) napisana je u Kotlinu\footnote{\url{https://kotlinlang.org}} koristeći Spring Framework\footnote{\url{https://spring.io/projects/spring-framework}}. Kotlin omogućuje interoperabilnost s jezikom Java\footnote{\url{https://java.com/en}} (može se koristiti zajedno s njim u sklopu istog projekta te koristiti njegove biblioteke). Spring Framework je open-source radni okvir za razvoj aplikacija baziranih na Javi. On implementira inverziju kontrole (IoC), uvođenje ovisnosti (DI), Model-View-Controller (MVC), pristup podacima, sigurnost i Spring Boot. \\
Pokretanje, izvršavanje i puštanje u pogon izvršavaju se preko 3 kontejnera platforme Docker koji pokrivaju najvažnije dijelove aplikacije: back-end, front-end i PostgreSQL bazu podataka. Pri deployment-u projekta koristimo radni okvir Express.js\footnote{\url{https://expressjs.com}} za izgradnju API-ja s Node.js\footnote{\url{https://nodejs.org/en}} radnim okruženjem.

			
			\eject 
		
	
		\section{Ispitivanje programskog rješenja}
	
			
			\subsection{Ispitivanje komponenti}
			
			Komponente programskog sustava ostvaruju određenu funkcionalnost te međusobno imaju usku komunikaciju preko raznih ponuđenih sučelja. Pomoću unit testova provjeravamo ispravnost i pravilno ponašanje pojedinačnih „jedinica“ komponenti, najčešće funkcija ili metoda. To su najmanji dijelovi softverskog sustava koji se mogu testirati odvojeno, a provođenjem unit testiranja poboljšavamo kvalitetu koda tijekom vremena te identificiramo eventualne probleme. \\
			
Ispitivanje komponenti ostvareno je preko JUnit radnog okvira, a proveli smo 2 vrste testova: unos ispravne varijante koja zadovoljava unit testove, a i one druge kako bi smo provjerili reakciju sustava na neki neprihvatljiv unos.  Prilikom testiranja UserService metoda, korišteno je sučelje UserRepository uz klase User i DTO objekti koji su korišteni za entitet User.\\
Proveli smo sveukupno 6 unit testova te u nastavku slijede njihovi opisi i slike kodova.

\pagebreak

\textbf{Ispitni slučaj 1: Najprije smo testirali funkcionalnost logiranja. Prvi test provjerava uspješno logiranje sa unaprijed zadanim emailom i \textit{password}-om.}

\begin{figure}[H]
			\includegraphics[scale=0.5]{slike/unit1.PNG} 
			\centering
			\caption{Unit test 1 - \textit{log-in}}
			\label{unit1}
		\end{figure}

\pagebreak
\textbf{Ispitni slučaj 2: Drugi test provjerava logiranje sa neispravnim \textit{password}-om.}

\begin{figure}[H]
			\includegraphics[scale=0.5]{slike/unit2.PNG} 
			\centering
			\caption{Unit test 2 - \textit{log-in} s neispravnim \textit{password}-om}
			\label{unit2}
		\end{figure}

\pagebreak		
\textbf{Ispitni slučaj 3: Treći test provjerava uspješnu registraciju.}

\begin{figure}[H]
			\includegraphics[scale=0.5]{slike/unit3.PNG} 
			\centering
			\caption{Unit test 3 - registracija}
			\label{unit3}
		\end{figure}
		
\pagebreak		
\textbf{Ispitni slučaj 4: U četvrtom testu testiramo pokušaj registracije sa \textit{e-mail}-om koji je već u uporabi.}

\begin{figure}[H]
			\includegraphics[scale=0.5]{slike/unit4.PNG} 
			\centering
			\caption{Unit test 4 - registracija s već postojećim \textit{e-mail}-om}
			\label{unit4}
		\end{figure}

\pagebreak		
\textbf{Ispitni slučaj 5: Peti test testira rutu dohvaćanja svih korisnika koji su prijavljeni kao sklonište odnosno "shelter".}

\begin{figure}[H]
			\includegraphics[scale=0.5]{slike/unit5.PNG} 
			\centering
			\caption{Unit test 5 - dohvaćanje rute svih korisnika}
			\label{unit5}
		\end{figure}
		
\pagebreak
\textbf{Ispitni slučaj 6: U šestom testu testiramo dodavanje novog oglasa.}		
		
\begin{figure}[H]
			\includegraphics[scale=0.5]{slike/unit6.PNG} 
			\centering
			\caption{Unit test 6 - dodavanje novog oglasa}
			\label{unit6}
		\end{figure}

\pagebreak
		
\textbf{Prikaz rezultata unit testova}\\

Prvih 5 unit testova služi za testiranje metoda iz UserService-a i to su testovi loginValidTest, loginInvalidTest, registerValidTest, registerInvalidTest i getAllSheltersTest. Svi testovi su bili uspješni.

\begin{figure}[H]
			\includegraphics[scale=0.45]{slike/5unitrez.PNG} 
			\centering
			\caption{Prikaz prolaznosti unit testova (1. - 5.)}
			\label{unit6}
		\end{figure}
		
		
Zadnji test (addNewAd) služi za testiranje metode iz AdService-a s kojom imamo mogućnost dodavanja novog oglasa. Test je također bio uspješan.

\begin{figure}[H]
			\includegraphics[scale=0.45]{slike/1unitrez.PNG} 
			\centering
			\caption{Prikaz prolaznosti 6. unit testa}
			\label{unit6}
		\end{figure}
		
\pagebreak
	
			\subsection{Ispitivanje sustava}
			
			 \textit{Potrebno je provesti i opisati ispitivanje sustava koristeći radni okvir Selenium\footnote{\url{https://www.seleniumhq.org/}}. Razraditi \textbf{minimalno 4 ispitna slučaja} u kojima će se ispitati redovni slučajevi, rubni uvjeti te poziv funkcionalnosti koja nije implementirana/izaziva pogrešku kako bi se vidjelo na koji način sustav reagira kada nešto nije u potpunosti ostvareno. Ispitni slučaj se treba sastojati od ulaza (npr. korisničko ime i lozinka), očekivanog izlaza ili rezultata, koraka ispitivanja i dobivenog izlaza ili rezultata.\\ }
			 
			 \textit{Izradu ispitnih slučajeva pomoću radnog okvira Selenium moguće je provesti pomoću jednog od sljedeća dva alata:}
			 \begin{itemize}
			 	\item \textit{dodatak za preglednik \textbf{Selenium IDE} - snimanje korisnikovih akcija radi automatskog ponavljanja ispita	}
			 	\item \textit{\textbf{Selenium WebDriver} - podrška za pisanje ispita u jezicima Java, C\#, PHP koristeći posebno programsko sučelje.}
			 \end{itemize}
		 	\textit{Detalji o korištenju alata Selenium bit će prikazani na posebnom predavanju tijekom semestra.}
			
			\eject 
		
		
		\section{Dijagram razmještaja}
			
			Sustav se zasniva na arhitekturi "klijent - poslužitelj". Klijenti koriste web preglednik za pristupanje web aplikaciji. Komunikacija klijenata i poslužitelja odvija se preko HTTP veze. Za posluživanje se koristi platforma Render.
			 
			 \begin{figure}[H]
				\includegraphics[scale=0.6]{slike/dijagram_razmjestaja.PNG} 
				\centering
				\caption{Dijagram razmještaja}
				\label{dijagram_razmjestaja}
			\end{figure}
			
			\eject 
		
		\section{Upute za puštanje u pogon}
		
			Izvorni kod aplikacije postavljen je na GitHub repozitorij na adresi \url{https://github.com/Ljubimci-Grupa-1/ForAllTheDogs}. Puštanje u pogon obavit ćemo uz pomoć platforme Render\footnote{\url{https://render.com}}.
			
			\subsection{Frontend}
			
			U datoteku \textbf{package.json} dodajemo "dotenv", "express" i "http-proxy-middleware" ovisnosti (engl. \textit{dependencies}) kao što je prikazano na slici \ref{dependencies}.
			
			\begin{figure}[H]
				\includegraphics[scale=0.6]{slike/dependencies.PNG} 
				\centering
				\caption{"dependencies" u package.json}
				\label{dependencies}
			\end{figure}
			
			Datoteku \textbf{server.js}, prikazanu na slici \ref{server_js}, stavljamo u korijenski direktorij za frontend. Ona sadrži konfiguraciju za Express server koji koristimo za posluživanje frontenda.
			
			\begin{figure}[H]
				\includegraphics[scale=0.6]{slike/server_js.PNG} 
				\centering
				\caption{Sadržaj datoteke server.js}
				\label{server_js}
			\end{figure}
			
			Zatim se vraćamo u datoteku \textbf{package.json} i ažuriramo "scripts" kao na slici \ref{scripts} te obavimo \textit{git push}.
			
			\begin{figure}[H]
				\includegraphics[scale=0.4]{slike/scripts.PNG} 
				\centering
				\caption{"scripts" u package.json}
				\label{scripts}
			\end{figure}
			
			Prijavljujemo se na \url{https://dashboard.render.com} svojim korisničkim podacima te odabiremo \textit{New} $\rightarrow$ \textit{Web Service}. Nakon odabira našeg GitHub repozitorija postavljamo željeno ime, regiju (EU Central), odgovarajuću granu repozitorija (main), te ime korijenskog direktorija za frontend dio aplikacije (direktorij \textbf{frontend}).
			
			\begin{figure}[H]
				\includegraphics[scale=0.6]{slike/frontend_1.PNG} 
				\centering
				\caption{Postavljanje Web Service}
				\label{frontend_1}
			\end{figure}
			
			Nadalje navodimo \textit{Build} i \textit{Start} naredbe koje će biti pokrenute u odabranom korijenskom direktoriju. Naredba \textit{Build} (u našem slučaju \textit{yarn build}) odgovorna je za instalaciju potrebnih programskih biblioteka i kompilaciju koda (uz automatski \textit{redeployment} prilikom svake promjene izvornog koda na GitHub repozitoriju). Naredba \textit{Start} (u našem slučaju \textit{yarn start-prod}) služi za pokretanje aplikacije odnosno web poslužitelja.
			
			\begin{figure}[H]
				\includegraphics[scale=0.6]{slike/frontend_2.PNG} 
				\centering
				\caption{Build i Start}
				\label{frontend_2}
			\end{figure}
			
			Za kraj odabiremo opciju \textit{Create Web Service}.
			
			\subsection{Baza podataka}
			
			Na Render Dashboard odabiremo \textit{New} $\rightarrow$ \textit{PostgreSQL}. Ispunjavamo željene postavke (ime, regija, PostgreSQL verzija (15) itd.) te završavamo s \textit{Create Database}.
			
			\subsection{Backend}
			
			Za puštanje backenda u pogon ponovno odabiremo \textit{New} $\rightarrow$ \textit{Web Service} te kao korijenski direktorij odabiremo direktorij \textbf{backend}.
			
			\begin{figure}[H]
				\includegraphics[scale=0.6]{slike/backend.PNG} 
				\centering
				\caption{Postavke za backend}
				\label{backend}
			\end{figure}
			
			Kao \textit{Runtime} postavljamo Docker. Datoteka Dockerfile, pozicionirana u korijenskom direktoriju za backend, sadrži instrukcije za izgradnju i pakiranje (engl. \textit{build-and-package}) aplikacije. Objasnimo sadržaj datoteke Dockerfile.
			
			Prvo se definira "builder".
			
			\begin{figure}[H]
				\includegraphics[scale=0.5]{slike/dockerfile_builder.PNG} 
				\centering
				\caption{builder}
				\label{dockerfile_builder}
			\end{figure}
			
			Zatim se zadaje radni direktorij te u kontejner kopira konfiguracijske datoteke alata Gradle (\textbf{build.gradle.kts} i \textbf{settings.gradle.kts}), skripte Gradle omotača (\textit{Gradle Wrapper}) te izvorni kod aplikacije.
			
			\begin{figure}[H]
				\includegraphics[scale=0.6]{slike/dockerfile_workdir.PNG} 
				\centering
				\caption{Radni direktorij i Gradle}
				\label{dockerfile_workdir}
			\end{figure}
			
			Naredbe na slici \ref{dockerfile_run} (redom) služe za: 
			\begin{packed_item}
				\item davanje skripti Gradle omotača pravo izvršavanja (\textit{execute} permission)
				\item preuzimanje \textit{project dependencies}
				\item izgradnju aplikacije
			\end{packed_item}
			
			\begin{figure}[H]
				\includegraphics[scale=0.6]{slike/dockerfile_run.PNG} 
				\centering
				\caption{Naredbe za izgradnju}
				\label{dockerfile_run}
			\end{figure}
			
			Na kraju imamo naredbe vezane uz \textit{staging}. Pokrećemo novi \textit{stage} koji koristi istu osnovnu sliku za izvođenje aplikacije (\textit{build stage} više nam nije potreban, kopiraju se samo potrebni artefakti). Izgrađena JAR datoteka (iz \textit{build stage}) kopira se u trenutni \textit{stage}. Zatim su navedene naredbe koje će biti izvedene pri pokretanju kontejnera. Aplikacija se pokreće kao izvršna datoteka (\textit{executable}).
			
			\begin{figure}[H]
				\includegraphics[scale=0.45]{slike/dockerfile_stage.PNG} 
				\centering
				\caption{Naredbe za \textit{staging}}
				\label{dockerfile_stage}
			\end{figure}
			
			Kao i prije, završavamo s \textit{Create Web Service}.
			
			\eject 